
log = load '/sample.log'; 
LEVELS = foreach log generate REGEX_EXTRACT($0, '(TRACE|DEBUG|INFO|WARN|ERROR|FATAL)', 1)  as LOGLEVEL;
dump LEVELS;
FILTEREDLEVELS = FILTER LEVELS by LOGLEVEL is not null;
dump FILTEREDLEVEL;
GROUPEDLEVELS = GROUP FILTEREDLEVELS by LOGLEVEL;
FREQUENCIES = foreach GROUPEDLEVELS generate group as LOGLEVEL, COUNT(FILTEREDLEVELS.LOGLEVEL) as COUNT;
dump FREQUENCIES;
RESULT = order FREQUENCIES by COUNT desc;
STORE RESULT into ‘/pigresults’

